# 图片压缩功能说明

## 功能概述

在教师端上传照片时，系统会自动检测图片大小，如果单张照片大于3MB，会自动进行压缩处理，确保压缩后的图片大小小于3MB。

## 技术实现

### 1. 压缩工具 (`frontend/src/utils/imageCompression.js`)

- **压缩算法**: 使用Canvas API进行图片压缩
- **压缩策略**: 
  - 首先按比例缩小图片尺寸（最大2048px）
  - 然后调整JPEG质量参数
  - 迭代压缩直到达到目标大小
- **支持格式**: JPG、JPEG、PNG、BMP、TIFF、WEBP
- **大小限制**: 
  - 最大支持原始图片50MB
  - 压缩目标3MB以下

### 2. 集成位置

- **主要文件**: `frontend/src/views/teacher/PhotoUpload.vue`
- **触发时机**: 在`beforeUpload`函数中检测文件大小
- **用户体验**: 
  - 显示压缩进度提示
  - 显示压缩前后大小对比
  - 压缩失败时使用原文件

## 使用方法

### 教师端上传照片

1. 进入教师端照片上传页面 (`/teacher/upload`)
2. 选择或拖拽图片文件
3. 系统自动检测文件大小：
   - 小于3MB：直接上传
   - 大于3MB：自动压缩后上传
4. 查看压缩结果提示

### 测试功能

访问测试页面 `/test-compression` 可以：
- 测试图片压缩功能
- 查看压缩前后大小对比
- 验证压缩比例

## 压缩效果

- **压缩比例**: 通常可达到50-80%的压缩率
- **图片质量**: 保持较好的视觉效果
- **处理速度**: 通常在1-3秒内完成压缩

## 错误处理

- 如果压缩失败，系统会使用原文件继续上传
- 超过50MB的图片会被拒绝上传
- 不支持的图片格式会被拒绝上传

## 注意事项

1. 压缩过程在浏览器端进行，不会增加服务器负担
2. 压缩后的图片会保持原始文件名和格式
3. 压缩是不可逆的，建议保留原始图片备份
4. 系统会自动处理压缩失败的情况，确保上传流程不中断 